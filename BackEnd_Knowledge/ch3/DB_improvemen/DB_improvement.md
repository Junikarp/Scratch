# DB 설계 시 고려 사항
> DB 설계 시 성능을 위해 어떤 부분을 고려하면 좋을까요?
---
## 인덱스 설계
> DB 테이블을 설계할 때에는 트래픽 규모를 고려해야함
> 특히 풀 스캔이 발생할 수 있는 테이블에서는 조회 패턴을 기준으로 적절한 인덱스를 설계해야 한다

### 단일 인덱스와 복합 인덱스
> 적은 데이터를 가진 상황에서는 단일 인덱스를 사용가능하다.
> 하지만 단일 인덱스로 검색 시 데이터의 양이 많다면 복합 인덱스를 고려할 만 하다.

예를 들어 유저의 아이디 컬럼인 userId 와 작성글에 대한 컬럼 post 가 있다고 가정하자.
유저의 작성글이 적을때는 상관없지만 한 사람의 유저가 수만건 이상의 글을 적는다면?
한 사람당 작성글 조회 시 수만건의 데이터를 불러와야 할 것이고 성능 저하로 이어질 것이다. <br>

이 때 userId 와 글 작성 시간인 date 라는 컬럼을 복합 인덱스로 작성하면 날짜에 따라 더 적은 데이터를 가져오므로
성능을 개선하는 것이 가능하다.

### 선택도
> 인덱스를 생성할 때는 선택도가 높은 컬럼을 골라야 성능 향상에 도움이 된다.
> 선택도는 인덱스에서 고유한 값을 가진 컬럼의 종류의 수라고 이해하면 될 것 같다.
> 선택도가 높더라도 적은 수의 데이터만 갖는 컬럼을 자주 조회할 경우 인덱스를 고려할 만 하다.

### 커버링 인덱스
> 커버링 인덱스란 특정 쿼리를 실행하는데 필요한 컬럼이 모두 포함된 인덱스이다.

아래의 예시로 이해해보자.

| id | name | age | city |
|---|---|---|---|
| 1 | 김철수 | 30 | 서울 |
| 2 | 이영희 | 25 | 부산 |
| 3 | 박민준 | 35 | 대구 |

위 테이블은 이름과 나이, 사는 곳에 대한 간단한 테이블이다.
이 때 우리가 조회하는 내용이 사용자의 이름과 나이만 필요로 한다고 가정해보자.

| name | age |
|---|---|
| 김철수 | 30 |
| 박민준 | 35 |
| 이영희 | 25 |

위와 같이 커버링 인덱스를 만들어서 사용할 수 있다.

```sql
SELECT name, age FROM users WHERE name = '박민준';
```
위와 같은 쿼리에서 커버링 인덱스에 필요한 모든 정보가 포함되므로 원본 테이블에 정보를 요청할 필요가 없다.
따라서 실제 데이터를 읽어오는 과정이 생략되므로 쿼리 실행 시간이 빨라진다.

